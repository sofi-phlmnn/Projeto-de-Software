{% extends "base.html" %}
{% load static %}

{% block title %}PUC Oportunidades — Entidades Estudantis{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/entidades.css' %}">
{% endblock %}

{% block content %}

<section class="boxtext">
  <h2>Entidades Estudantis na PUC-Rio</h2>
  <p>Explore representantes estudantis, empresas juniores, coletivos e ligas.</p>
</section>

<section class="entidades-container">
  {% for e in entidades %}
    <article class="entity favorito-card">

      {# ⭐ botão de favorito #}
      {% if request.user.is_authenticated %}
        <form method="post"
              action="{% url 'core:toggle_favorito' 'entidade' e.id %}"
              class="fav-form">
          {% csrf_token %}
          <input type="hidden" name="next" value="{{ request.path }}">
          <button type="submit"
                  class="icon-btn"
                  title="{% if e.is_fav %}Remover dos favoritos{% else %}Adicionar aos favoritos{% endif %}">
            <span class="material-icons-outlined">
              {% if e.is_fav %}star{% else %}star_border{% endif %}
            </span>
          </button>
        </form>
      {% endif %}

      <header class="entity-header">
        <img class="entity-logo" src="{% static 'img/'|add:e.img %}" alt="Logo da {{ e.nome }}">
        <h3 class="entity-name">{{ e.nome }}</h3>
      </header>

      <p class="entity-desc">{{ e.descricao }}</p>

      <ul class="entity-meta">
        <li>
          <span class="material-icons-outlined">category</span>
          {{ e.tipo }}
        </li>

        {% for item in e.contatos %}
          <li>
            <span class="material-icons-outlined">{{ item.icone }}</span>
            {{ item.texto }}
          </li>
        {% endfor %}
      </ul>

      <!-- botão de ver detalhes -->
      <a class="btn-entity" href="{% url 'core:entidade_detalhe' e.id %}">
        Ver detalhes completos
      </a>
    </article>
  {% empty %}
    <p class="no-entities">Nenhuma entidade estudantil encontrada no momento.</p>
  {% endfor %}
</section>

{% endblock %}