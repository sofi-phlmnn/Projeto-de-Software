{% extends "base.html" %}
{% load static %}

{% block title %}PUC Oportunidades — Estágios e Inovação{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/estagios.css' %}">
{% endblock %}

{% block content %}

<p class="boxtext">
  <strong>Programas de Estágio e Inovação</strong> conectam aprendizado prático, tecnologia e desenvolvimento profissional com a vivência real do mercado.
  Aqui você encontra iniciativas que ampliam suas habilidades e impulsionam sua formação acadêmica e profissional.
</p>

<section class="estagios-container">
  {% for e in estagios %}
    <article class="estagio-card favorito-card">

      {# ⭐ botão de favorito #}
      {% if request.user.is_authenticated %}
        <form method="post"
              action="{% url 'core:toggle_favorito' 'estagio' e.id %}"
              class="fav-form">
          {% csrf_token %}
          <input type="hidden" name="next" value="{{ request.path }}">
          <button type="submit"
                  class="icon-btn"
                  title="{% if e.is_fav %}Remover dos favoritos{% else %}Adicionar aos favoritos{% endif %}">
            <span class="material-icons-outlined">
              {% if e.is_fav %}star{% else %}star_border{% endif %}
            </span>
          </button>
        </form>
      {% endif %}

      <h2 class="nomestagio">{{ e.nome }}</h2>

      <p class="desestagio">{{ e.descricao }}</p>

      {% if e.topicos_lista %}
        <div class="lista-topicos">
          {{ e.topicos_lista|safe }}
        </div>
      {% endif %}

      <a class="btn-estagios" href="{% url 'core:estagio_detalhe' e.id %}">
        Ver detalhes completos
      </a>
    </article>
  {% empty %}
    <p class="no-estagios">Nenhum programa de estágio cadastrado no momento.</p>
  {% endfor %}
</section>

{% endblock %}