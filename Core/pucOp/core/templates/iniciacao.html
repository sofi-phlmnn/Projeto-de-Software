{% extends "base.html" %}
{% load static %}

{% block title %}PUC Oportunidades — Iniciação Científica{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static 'css/iniciacao.css' %}">
{% endblock %}

{% block content %}

<section class="boxtext">
  <h2>Oportunidades de Iniciação Científica</h2>
  <p>
      Programas, laboratórios e projetos de pesquisa disponíveis para alunos da PUC-Rio.
  </p>
</section>

<main class="container">
  {% for p in iniciacoes %}
    <div class="program favorito-card">

      {# ⭐ botão de favorito #}
      {% if request.user.is_authenticated %}
        <form method="post"
              action="{% url 'core:toggle_favorito' 'iniciacao' p.id %}"
              class="fav-form">
          {% csrf_token %}
          <input type="hidden" name="next" value="{{ request.path }}">
          <button type="submit"
                  class="icon-btn"
                  title="{% if p.is_fav %}Remover dos favoritos{% else %}Adicionar aos favoritos{% endif %}">
            <span class="material-icons-outlined">
              {% if p.is_fav %}star{% else %}star_border{% endif %}
            </span>
          </button>
        </form>
      {% endif %}

      <h3 class="nomeinic">{{ p.nome }}</h3>
      <p class="desinic">{{ p.descricao }}</p>

      <div class="detalhes-topicos">
        {{ p.topicos_lista|safe }}
      </div>

      <a class="btn-iniciacao" href="{% url 'core:iniciacao_detalhe' p.id %}">
        Ver detalhes completos
      </a>
    </div>
  {% empty %}
    <p class="no-data">Nenhuma oportunidade de iniciação científica está disponível no momento.</p>
  {% endfor %}
</main>

{% endblock %}